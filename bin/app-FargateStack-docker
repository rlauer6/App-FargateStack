#!/bin/bash
#-*- mode: sh; -*-

if ! [ -e $HOME/.aws/credentials ]; then
    echo "ERROR: no credentials file found!";
    exit 1;
fi
command=${1:-help};
shift;


docker run --rm -it \
   --user $(id -u):$(id -g) \
   -v $(pwd):$HOME \
   -v $HOME/.aws/credentials:$HOME/.aws/credentials \
   -e HOME=$HOME \
   -e AWS_PROFILE="$AWS_PROFILE" \
   app-fargatestack \
   /bin/bash -c  "cd $HOME && app-FargateStack $command $*"
